--
-- VHDL Test Bench idx_fpga_lib.mock_ad7687_chain_tb.mock_ad7687_chain_tester
--
-- Created:
--          by - nort.UNKNOWN (NORT-NBX200T)
--          at - 10:11:43 10/28/2010
--
-- Generated by Mentor Graphics' HDL Designer(TM) 2009.2 (Build 10)
--
LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_arith.all;


ENTITY mock_ad7687_chain_tb IS
END mock_ad7687_chain_tb;


LIBRARY idx_fpga_lib;
-- USE idx_fpga_lib.ALL;


ARCHITECTURE rtl OF mock_ad7687_chain_tb IS

   -- Architecture declarations

   -- Internal signal declarations
   SIGNAL SCK16 : std_ulogic;
   SIGNAL Conv  : std_ulogic;
   SIGNAL RST   : std_ulogic;
   SIGNAL SDO   : std_ulogic;
   SIGNAL Row   : std_ulogic_vector(2 DOWNTO 0);
   SIGNAL Bank  : std_ulogic;
   SIGNAL RN : unsigned (2 DOWNTO 0);
   SIGNAL Done  : std_ulogic;


   -- Component declarations
   COMPONENT mock_ad7687_chain
      PORT (
         SCK16 : IN     std_ulogic;
         Conv  : IN     std_ulogic;
         RST   : IN     std_ulogic;
         SDO   : OUT    std_ulogic;
         Row   : IN     std_ulogic_vector(2 DOWNTO 0);
         Bank  : IN     std_ulogic
      );
   END COMPONENT;

   -- embedded configurations
   -- pragma synthesis_off
   FOR DUT_mock_ad7687_chain : mock_ad7687_chain USE ENTITY idx_fpga_lib.mock_ad7687_chain;
   -- pragma synthesis_on

BEGIN

  DUT_mock_ad7687_chain : mock_ad7687_chain
    PORT MAP (
       SCK16 => SCK16,
       Conv  => Conv,
       RST   => RST,
       SDO   => SDO,
       Row   => Row,
       Bank  => Bank
    );
    
  test_proc : Process
    Begin
      Done <= '0';
      Conv <= '1';
      SCK16 <= '1';
      RN <= conv_unsigned(0,3);
      Row <= "000";
      Bank <= '0';
      RST <= '1';
      -- pragma synthesis_off
      wait for 200 ns;
      RST <= '0';
      for r in 0 to 7 loop
        Row <= To_StdULogicVector(conv_std_logic_vector(RN,3));
        RN <= RN+1;
        wait for 200 ns;
        Conv <= '0';
        wait for 200 ns;
        Conv <= '1';
        wait until SDO = '1';
        wait for 40 ns;
        Conv <= '0';
        wait for 200 ns;
        Conv <= '1';
        wait until SDO = '1';
        wait for 40 ns;
        for c in 0 to 7 loop
          for b in 0 to 15 loop
            SCK16 <= '0';
            wait for 33 ns;
            SCK16 <= '1';
            wait for 33 ns;
          end loop;
        end loop;
      end loop;
      wait;
      -- pragma synthesis_on
    End Process;

END rtl;