--
-- VHDL Test Bench idx_fpga_lib.bench_ao_sm.ao_sm_tester
--
-- Created:
--          by - nort.UNKNOWN (NORT-NBX200T)
--          at - 10:33:28 02/ 2/2011
--
-- Generated by Mentor Graphics' HDL Designer(TM) 2009.2 (Build 10)
--
LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_arith.all;


ENTITY bench_ao_sm IS
END bench_ao_sm;


LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_arith.all;
LIBRARY idx_fpga_lib;


ARCHITECTURE rtl OF bench_ao_sm IS

   -- Architecture declarations

   -- Internal signal declarations
   SIGNAL Addr      : std_logic_vector(15 DOWNTO 0);
   SIGNAL DA_CLR_B  : std_logic;
   SIGNAL DA_CS_B   : std_logic_vector(1 DOWNTO 0);
   SIGNAL DA_LDAC_B : std_logic;
   SIGNAL DA_SCK    : std_logic;
   SIGNAL DA_SDI    : std_logic;
   SIGNAL F25M      : std_logic;
   SIGNAL iData     : std_logic_vector(15 DOWNTO 0);
   SIGNAL rst       : std_ulogic;
   SIGNAL WrEn      : std_ulogic;
   SIGNAL Done      : std_ulogic;


   -- Component declarations
   COMPONENT ao_sm
      PORT (
         Addr      : IN     std_logic_vector(15 DOWNTO 0);
         DA_CLR_B  : OUT    std_logic;
         DA_CS_B   : OUT    std_logic_vector(1 DOWNTO 0);
         DA_LDAC_B : OUT    std_logic;
         DA_SCK    : OUT    std_logic;
         DA_SDI    : OUT    std_logic;
         F25M      : IN     std_logic;
         iData     : IN     std_logic_vector(15 DOWNTO 0);
         rst       : IN     std_ulogic;
         WrEn      : IN     std_ulogic
      );
   END COMPONENT;

   -- embedded configurations
   -- pragma synthesis_off
   FOR DUT_ao_sm : ao_sm USE ENTITY idx_fpga_lib.ao_sm;
   -- pragma synthesis_on

BEGIN

     DUT_ao_sm : ao_sm
        PORT MAP (
           Addr      => Addr,
           DA_CLR_B  => DA_CLR_B,
           DA_CS_B   => DA_CS_B,
           DA_LDAC_B => DA_LDAC_B,
           DA_SCK    => DA_SCK,
           DA_SDI    => DA_SDI,
           F25M      => F25M,
           iData     => iData,
           rst       => rst,
           WrEn      => WrEn
        );

    -- Approximately 25 MHz
    clock : Process
    Begin
      F25M <= '0';
      -- pragma synthesis_off
      wait for 40 ns;
      while Done = '0' loop
        F25M <= '0';
        wait for 20 ns;
        F25M <= '1';
        wait for 20 ns;
      end loop;
      wait;
      -- pragma synthesis_on
    End Process;

    test_proc : Process Is
      Begin
        Done <= '0';
        rst <= '1';
        Addr <= X"0000";
        iData <= X"0000";
        WrEn <= '0';
        -- pragma synthesis_off
        wait until F25M'Event AND F25M = '1';
        wait until F25M'Event AND F25M = '1';
        rst <= '0';
        wait until F25M'Event AND F25M = '1';
        wait until F25M'Event AND F25M = '1';
        wait until F25M'Event AND F25M = '1';
        Addr <= X"0406";
        iData <= X"1234";
        WrEn <= '1';
        wait until F25M'Event AND F25M = '1';
        WrEn <= '0';
        wait for 10 ns;
        assert DA_CS_B = "10"
          report "Expected DA_CS_B as 10"
          severity error;
        wait until DA_CS_B = "11";
        wait until F25M'Event AND F25M = '1';
        wait until F25M'Event AND F25M = '1';
        Addr <= X"0414";
        iData <= X"55AA";
        WrEn <= '1';
        wait until F25M'Event AND F25M = '1';
        WrEn <= '0';
        wait for 10 ns;
        assert DA_CS_B = "01"
          report "Expected DA_CS_B as 01"
          severity error;
        wait until DA_CS_B = "11";
        wait until F25M'Event AND F25M = '1';
        wait until F25M'Event AND F25M = '1';
        Done <= '1';
        wait;
        -- pragma synthesis_on
      End Process;
   


END rtl;