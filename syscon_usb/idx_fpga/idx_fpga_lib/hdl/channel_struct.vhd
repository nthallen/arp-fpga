-- VHDL Entity idx_fpga_lib.channel.symbol
--
-- Created:
--          by - nort.UNKNOWN (NORT-NBX200T)
--          at - 14:22:59 01/25/2011
--
-- Generated by Mentor Graphics' HDL Designer(TM) 2009.2 (Build 10)
--
LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_arith.all;

ENTITY channel IS
   PORT( 
      CMDENBL : IN     std_ulogic;
      ChanSel : IN     std_ulogic;
      F4M     : IN     std_ulogic;
      F8M     : IN     std_ulogic;
      INTA    : IN     std_ulogic;
      KillA   : IN     std_ulogic;
      KillB   : IN     std_ulogic;
      LimI    : IN     std_ulogic;
      LimO    : IN     std_ulogic;
      OpCd    : IN     std_logic_vector (2 DOWNTO 0);
      RdEn    : IN     std_ulogic;
      WrEn    : IN     std_ulogic;
      ZR      : IN     std_ulogic;
      rst     : IN     std_logic;
      Dir     : OUT    std_ulogic;
      Ireq    : OUT    std_ulogic;
      Run     : OUT    std_ulogic;
      Running : OUT    std_ulogic;
      Step    : OUT    std_ulogic;
      Data    : INOUT  std_logic_vector ( 15 DOWNTO 0 )
   );

-- Declarations

END channel ;

--
-- VHDL Architecture idx_fpga_lib.channel.struct
--
-- Created:
--          by - nort.UNKNOWN (NORT-NBX200T)
--          at - 14:23:01 01/25/2011
--
-- Generated by Mentor Graphics' HDL Designer(TM) 2009.2 (Build 10)
--
LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_arith.all;
USE ieee.std_logic_unsigned.all;
USE ieee.numeric_std.all;

LIBRARY idx_fpga_lib;

ARCHITECTURE struct OF channel IS

   -- Architecture declarations

   -- Internal signal declarations
   SIGNAL ArmZero  : std_ulogic;
   SIGNAL CfgEn    : std_ulogic;
   SIGNAL ClkEn    : std_ulogic;
   SIGNAL CtEn     : std_ulogic;
   SIGNAL DirOut   : std_ulogic;
   SIGNAL InLimit  : std_ulogic;
   SIGNAL Ld       : std_ulogic;
   SIGNAL Limit    : std_ulogic;
   SIGNAL OutLimit : std_ulogic;
   SIGNAL PosEn    : std_ulogic;
   SIGNAL ResetPos : std_ulogic;
   SIGNAL StepClk  : std_ulogic;
   SIGNAL StepEn   : std_ulogic;
   SIGNAL ZeroCt   : std_ulogic;
   SIGNAL ZeroRef  : std_logic;
   SIGNAL rclk     : std_ulogic;

   -- Implicit buffer signal declarations
   SIGNAL Running_internal : std_ulogic;


   -- Component Declarations
   COMPONENT ChOpDec
   PORT (
      ChanSel : IN     std_ulogic ;
      OpCd    : IN     std_logic_vector (2 DOWNTO 0);
      CfgEn   : OUT    std_ulogic ;
      CtEn    : OUT    std_ulogic ;
      PosEn   : OUT    std_ulogic 
   );
   END COMPONENT;
   COMPONENT CtState
   PORT (
      CtEn    : IN     std_ulogic ;
      F8M     : IN     std_ulogic ;
      PosEn   : IN     std_ulogic ;
      RdEn    : IN     std_ulogic ;
      StepClk : IN     std_ulogic ;
      WrEn    : IN     std_ulogic ;
      rst     : IN     std_logic ;
      ClkEn   : OUT    std_ulogic ;
      Ld      : OUT    std_ulogic 
   );
   END COMPONENT;
   COMPONENT DriveCtr
   PORT (
      ClkEn    : IN     std_ulogic;
      CtEn     : IN     std_ulogic;
      Data     : IN     std_logic_vector ( 15 DOWNTO 0 );
      DirOutIn : IN     std_ulogic;
      F8M      : IN     std_ulogic;
      Ld       : IN     std_ulogic;
      rst      : IN     std_logic;
      DirOut   : OUT    std_ulogic;
      ZeroCt   : OUT    std_ulogic
   );
   END COMPONENT;
   COMPONENT IO
   PORT (
      CMDENBL  : IN     std_ulogic;
      CfgEn    : IN     std_ulogic;
      DirOut   : IN     std_ulogic;
      F8M      : IN     std_ulogic;
      KZP      : IN     std_logic_vector (2 DOWNTO 0);
      KillA    : IN     std_ulogic;
      KillB    : IN     std_ulogic;
      LimI     : IN     std_ulogic;
      LimO     : IN     std_ulogic;
      RdEn     : IN     std_ulogic;
      Running  : IN     std_ulogic;
      StepClk  : IN     std_ulogic;
      WData    : IN     std_logic_vector (7 DOWNTO 0);
      WrEn     : IN     std_ulogic;
      ZR       : IN     std_ulogic;
      rst      : IN     std_logic;
      Dir      : OUT    std_ulogic;
      InLimit  : OUT    std_ulogic;
      OutLimit : OUT    std_ulogic;
      RData    : OUT    std_logic_vector ( 15 DOWNTO 0 );
      Run      : OUT    std_ulogic;
      Step     : OUT    std_ulogic;
      ZeroRef  : OUT    std_logic
   );
   END COMPONENT;
   COMPONENT Intr
   PORT (
      F8M     : IN     std_ulogic ;
      INTA    : IN     std_ulogic ;
      Running : IN     std_ulogic ;
      rst     : IN     std_logic ;
      Ireq    : OUT    std_ulogic 
   );
   END COMPONENT;
   COMPONENT Limits
   PORT (
      DirOut   : IN     std_ulogic ;
      F8M      : IN     std_ulogic ;
      InLimit  : IN     std_ulogic ;
      OutLimit : IN     std_ulogic ;
      rst      : IN     std_logic ;
      ArmZero  : OUT    std_ulogic ;
      Limit    : OUT    std_ulogic 
   );
   END COMPONENT;
   COMPONENT PosCtr
   PORT (
      RdEn     : IN     std_ulogic ;
      PosEn    : IN     std_ulogic ;
      F8M      : IN     std_ulogic ;
      rst      : IN     std_logic ;
      Ld       : IN     std_ulogic ;
      ClkEn    : IN     std_ulogic ;
      DirOut   : IN     std_ulogic ;
      ResetPos : IN     std_ulogic ;
      Data     : INOUT  std_logic_vector ( 15 DOWNTO 0 )
   );
   END COMPONENT;
   COMPONENT RateGen
   PORT (
      CfgEn   : IN     std_ulogic;
      F4M     : IN     std_ulogic;
      F8M     : IN     std_ulogic;
      WrEn    : IN     std_ulogic;
      ratesel : IN     std_logic_vector (3 DOWNTO 0);
      rst     : IN     std_ulogic;
      rclk    : OUT    std_ulogic
   );
   END COMPONENT;
   COMPONENT StepClkGen
   PORT (
      F8M     : IN     std_ulogic ;
      StepEn  : IN     std_ulogic ;
      rclk    : IN     std_ulogic ;
      rst     : IN     std_logic ;
      Running : OUT    std_ulogic ;
      StepClk : OUT    std_ulogic 
   );
   END COMPONENT;
   COMPONENT StepEnDef
   PORT (
      CMDENBL : IN     std_ulogic ;
      Limit   : IN     std_ulogic ;
      ZeroCt  : IN     std_ulogic ;
      StepEn  : OUT    std_ulogic 
   );
   END COMPONENT;
   COMPONENT Zero
   PORT (
      ArmZero  : IN     std_ulogic ;
      DirOut   : IN     std_ulogic ;
      F8M      : IN     std_ulogic ;
      ZeroRef  : IN     std_logic ;
      rst      : IN     std_logic ;
      ResetPos : OUT    std_ulogic 
   );
   END COMPONENT;

   -- Optional embedded configurations
   -- pragma synthesis_off
   FOR ALL : ChOpDec USE ENTITY idx_fpga_lib.ChOpDec;
   FOR ALL : CtState USE ENTITY idx_fpga_lib.CtState;
   FOR ALL : DriveCtr USE ENTITY idx_fpga_lib.DriveCtr;
   FOR ALL : IO USE ENTITY idx_fpga_lib.IO;
   FOR ALL : Intr USE ENTITY idx_fpga_lib.Intr;
   FOR ALL : Limits USE ENTITY idx_fpga_lib.Limits;
   FOR ALL : PosCtr USE ENTITY idx_fpga_lib.PosCtr;
   FOR ALL : RateGen USE ENTITY idx_fpga_lib.RateGen;
   FOR ALL : StepClkGen USE ENTITY idx_fpga_lib.StepClkGen;
   FOR ALL : StepEnDef USE ENTITY idx_fpga_lib.StepEnDef;
   FOR ALL : Zero USE ENTITY idx_fpga_lib.Zero;
   -- pragma synthesis_on


BEGIN

   -- Instance port mappings.
   ChOpDec_i : ChOpDec
      PORT MAP (
         ChanSel => ChanSel,
         OpCd    => OpCd,
         CfgEn   => CfgEn,
         CtEn    => CtEn,
         PosEn   => PosEn
      );
   CtState_i : CtState
      PORT MAP (
         CtEn    => CtEn,
         F8M     => F8M,
         PosEn   => PosEn,
         RdEn    => RdEn,
         StepClk => StepClk,
         WrEn    => WrEn,
         rst     => rst,
         ClkEn   => ClkEn,
         Ld      => Ld
      );
   DriveCtr_i : DriveCtr
      PORT MAP (
         CtEn     => CtEn,
         DirOutIn => OpCd(1),
         DirOut   => DirOut,
         Ld       => Ld,
         ClkEn    => ClkEn,
         Data     => Data,
         rst      => rst,
         F8M      => F8M,
         ZeroCt   => ZeroCt
      );
   IO_i : IO
      PORT MAP (
         CMDENBL  => CMDENBL,
         CfgEn    => CfgEn,
         DirOut   => DirOut,
         F8M      => F8M,
         KillA    => KillA,
         KillB    => KillB,
         LimI     => LimI,
         LimO     => LimO,
         RdEn     => RdEn,
         Running  => Running_internal,
         StepClk  => StepClk,
         WrEn     => WrEn,
         ZR       => ZR,
         KZP      => Data(14 DOWNTO 12),
         rst      => rst,
         Dir      => Dir,
         InLimit  => InLimit,
         OutLimit => OutLimit,
         Run      => Run,
         Step     => Step,
         ZeroRef  => ZeroRef,
         RData    => Data,
         WData    => Data(7 DOWNTO 0)
      );
   Intr_i : Intr
      PORT MAP (
         F8M     => F8M,
         INTA    => INTA,
         Running => Running_internal,
         rst     => rst,
         Ireq    => Ireq
      );
   Limits_i : Limits
      PORT MAP (
         DirOut   => DirOut,
         F8M      => F8M,
         InLimit  => InLimit,
         OutLimit => OutLimit,
         rst      => rst,
         ArmZero  => ArmZero,
         Limit    => Limit
      );
   PosCtr_i : PosCtr
      PORT MAP (
         RdEn     => RdEn,
         PosEn    => PosEn,
         F8M      => F8M,
         rst      => rst,
         Ld       => Ld,
         ClkEn    => ClkEn,
         DirOut   => DirOut,
         ResetPos => ResetPos,
         Data     => Data
      );
   RateGen_i : RateGen
      PORT MAP (
         CfgEn   => CfgEn,
         F8M     => F8M,
         F4M     => F4M,
         WrEn    => WrEn,
         rclk    => rclk,
         ratesel => Data(11 DOWNTO 8),
         rst     => rst
      );
   StepClkGen_i : StepClkGen
      PORT MAP (
         F8M     => F8M,
         StepEn  => StepEn,
         rclk    => rclk,
         rst     => rst,
         Running => Running_internal,
         StepClk => StepClk
      );
   StepEnDef_i : StepEnDef
      PORT MAP (
         CMDENBL => CMDENBL,
         Limit   => Limit,
         ZeroCt  => ZeroCt,
         StepEn  => StepEn
      );
   Zero_i : Zero
      PORT MAP (
         ArmZero  => ArmZero,
         DirOut   => DirOut,
         F8M      => F8M,
         ZeroRef  => ZeroRef,
         rst      => rst,
         ResetPos => ResetPos
      );

   -- Implicit buffered output assignments
   Running <= Running_internal;

END struct;
